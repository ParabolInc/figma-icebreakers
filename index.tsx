import { allIcebreakers, generateRandomIcebreaker } from "./api"

const { widget } = figma
const { useSyncedState, AutoLayout, Frame, Text, SVG, Line } = widget

const PARABOL_URI = `https://www.parabol.co/?utm_campaign=icebreakers&utm_medium=figma-widget&utm_source=${figma.editorType}`

function Widget() {
  const [icebreaker, setIcebreaker] = useSyncedState('icebreaker', () => generateRandomIcebreaker(allIcebreakers()))

  return (
    <AutoLayout
      name="main"
      effect={[
        {
          type: "drop-shadow",
          color: "#44425833",
          offset: {
            x: 0,
            y: 3,
          },
          blur: 5,
        },
        {
          type: "drop-shadow",
          color: "#4442581F",
          offset: {
            x: 0,
            y: 1,
          },
          blur: 18,
        },
        {
          type: "drop-shadow",
          color: "#44425824",
          offset: {
            x: 0,
            y: 6,
          },
          blur: 10,
        },
      ]}
      fill="#FFF"
      cornerRadius={8}
      direction="vertical"
      width={576}
    >
      <AutoLayout
        name="top"
        overflow="visible"
        direction="vertical"
        spacing={8}
        padding={{
          top: 36,
          right: 0,
          bottom: 8,
          left: 0,
        }}
        width="fill-parent"
        verticalAlignItems="center"
        horizontalAlignItems="center"
      >
        <Frame
          name="Parabol_Logo_Color"
          overflow="visible"
          width={150}
          height={29.983}
        >
          <SVG
            name="Path 240_Path 241_Path 242_Path 243_Path 244_Path 245_Rectangle 196_Path 246_Path 247_Path 248_Path 249_Path 250_Path 251"
            height={30}
            width={150}
            src="<svg width='150' height='30' viewBox='0 0 150 30' fill='none' xmlns='http://www.w3.org/2000/svg'>
<path d='M45.6642 29.9827V6.70883H49.1473V8.61906C49.5722 7.97036 50.168 7.45156 50.8689 7.11986C51.723 6.66117 52.6793 6.42648 53.6487 6.43772C54.6758 6.3683 55.7052 6.53487 56.658 6.92466C57.6108 7.31444 58.4618 7.91712 59.1458 8.68652C60.4991 10.499 61.165 12.733 61.0248 14.9907C61.1497 17.2321 60.4765 19.4452 59.1245 21.2373C58.439 22.0191 57.5829 22.6327 56.6223 23.0306C55.6617 23.4286 54.6225 23.6003 53.585 23.5324C52.675 23.5432 51.7755 23.3368 50.9614 22.9302C50.2423 22.5893 49.62 22.0739 49.1511 21.431V29.9827H45.6642ZM50.1306 10.9616C49.2901 12.1311 48.8741 13.5525 48.9512 14.9907C48.8739 16.4288 49.2899 17.8503 50.1306 19.0198C50.4916 19.4833 50.9534 19.8586 51.481 20.1172C52.0085 20.3759 52.5881 20.5111 53.1756 20.5127C53.7632 20.5143 54.3434 20.3821 54.8723 20.1263C55.4013 19.8704 55.865 19.4976 56.2286 19.036C57.0709 17.861 57.4885 16.4344 57.4129 14.9907C57.4902 13.5529 57.0751 12.1317 56.2361 10.9616C55.8739 10.4976 55.4107 10.1223 54.8817 9.86424C54.3527 9.60613 53.7719 9.47198 53.1833 9.47198C52.5947 9.47198 52.0139 9.60613 51.4849 9.86424C50.956 10.1223 50.4928 10.4976 50.1306 10.9616' fill='#2D2D39'/>
<path d='M63.0981 18.5076C63.07 17.7323 63.2358 16.9623 63.5804 16.2672C63.9251 15.5722 64.4378 14.9741 65.072 14.5273C66.6059 13.5005 68.4293 12.9942 70.273 13.083H73.1302V12.3609C73.1629 11.9511 73.0976 11.5394 72.9399 11.1597C72.7822 10.78 72.5366 10.4432 72.2232 10.1771C71.5524 9.68529 70.7342 9.43636 69.9032 9.4712C69.217 9.43775 68.5396 9.63656 67.9804 10.0355C67.4212 10.4345 67.0127 11.0103 66.8211 11.67L63.6915 11.0116C64.004 9.67046 64.7867 8.48568 65.8978 7.67216C67.0725 6.83092 68.4901 6.397 69.9344 6.43657C74.3862 6.43657 76.6121 8.61957 76.6121 12.9856V23.2739H73.7224L73.3476 21.1075C72.7696 21.9065 71.9999 22.5472 71.1094 22.9707C70.2189 23.3943 69.2361 23.587 68.2516 23.5312H68.2041C66.8701 23.5781 65.567 23.1229 64.5523 22.2556C64.0495 21.7762 63.6587 21.1917 63.4078 20.5438C63.1568 19.8959 63.052 19.2007 63.1006 18.5076H63.0981ZM66.7124 18.5076C66.6936 18.7815 66.7347 19.0562 66.833 19.3125C66.9313 19.5688 67.0844 19.8006 67.2815 19.9916C67.4786 20.1827 67.7151 20.3284 67.9743 20.4186C68.2336 20.5089 68.5094 20.5414 68.7825 20.5141C69.8992 20.532 70.9838 20.141 71.8322 19.4147C72.2704 19.0296 72.6153 18.5498 72.8406 18.0117C73.0659 17.4736 73.1658 16.8913 73.1327 16.3088V15.934H70.1343C69.2486 15.886 68.3714 16.1281 67.6356 16.6236C67.3398 16.8363 67.1008 17.1184 66.9398 17.4453C66.7788 17.7721 66.7007 18.1335 66.7124 18.4976' fill='#2D2D39'/>
<path d='M80.4857 23.274V6.70903H83.9738V9.47006C84.4839 8.54395 85.2323 7.77101 86.1415 7.23125C86.9622 6.72403 87.9053 6.44939 88.87 6.43668C89.5904 6.43129 90.3048 6.56755 90.9726 6.83772L90.3779 9.9673C89.7974 9.61966 89.1291 9.4462 88.4527 9.46756C87.8015 9.50068 87.1698 9.70125 86.6187 10.0499C86.0676 10.3985 85.6158 10.8834 85.3069 11.4578C84.3182 13.1767 83.8547 15.1478 83.9738 17.1272V23.274H80.4857Z' fill='#2D2D39'/>
<path d='M91.8571 18.5076C91.829 17.7323 91.9948 16.9623 92.3395 16.2672C92.6841 15.5722 93.1968 14.9741 93.8311 14.5273C95.365 13.5005 97.1883 12.9942 99.032 13.083H101.889V12.3609C101.922 11.9511 101.857 11.5394 101.699 11.1597C101.541 10.7801 101.296 10.4433 100.982 10.1771C100.311 9.68538 99.4933 9.43646 98.6622 9.4712C97.9761 9.43775 97.2987 9.63656 96.7394 10.0355C96.1802 10.4345 95.7718 11.0103 95.5801 11.67L92.4505 11.0116C92.763 9.67046 93.5457 8.48568 94.6568 7.67216C95.8315 6.83092 97.2492 6.397 98.6935 6.43657C103.145 6.43657 105.371 8.61957 105.371 12.9856V23.2739H102.481L102.107 21.1075C101.529 21.9065 100.759 22.5472 99.8684 22.9707C98.9779 23.3943 97.9951 23.587 97.0106 23.5312H96.9631C95.6291 23.578 94.3261 23.1228 93.3113 22.2556C92.8085 21.7762 92.4178 21.1917 92.1668 20.5438C91.9159 19.8959 91.811 19.2007 91.8596 18.5076H91.8571ZM95.4714 18.5076C95.4526 18.7815 95.4938 19.0562 95.5921 19.3125C95.6904 19.5688 95.8434 19.8006 96.0405 19.9916C96.2377 20.1827 96.4741 20.3284 96.7333 20.4186C96.9926 20.5089 97.2684 20.5414 97.5416 20.5141C98.6582 20.532 99.7428 20.141 100.591 19.4147C101.029 19.0296 101.374 18.5498 101.6 18.0117C101.825 17.4736 101.925 16.8913 101.892 16.3088V15.934H98.8934C98.0076 15.8861 97.1304 16.1282 96.3947 16.6236C96.0988 16.8363 95.8599 17.1184 95.6988 17.4453C95.5378 17.7721 95.4597 18.1335 95.4714 18.4976' fill='#2D2D39'/>
<path d='M109.245 23.2751V0H112.728V8.5392C113.236 7.90519 113.891 7.404 114.635 7.07873C115.419 6.67352 116.285 6.45382 117.167 6.43657C118.206 6.36969 119.246 6.5432 120.206 6.94363C121.167 7.34405 122.022 7.9606 122.706 8.74534C124.055 10.5389 124.728 12.751 124.606 14.992C124.745 17.2464 124.077 19.4766 122.722 21.2837C122.037 22.0522 121.186 22.6542 120.234 23.044C119.281 23.4337 118.252 23.6008 117.225 23.5325C116.259 23.5418 115.306 23.3099 114.453 22.8578C113.748 22.5318 113.148 22.0146 112.722 21.3649V23.2751H109.245ZM113.712 10.9642C112.872 12.1334 112.456 13.5543 112.532 14.992C112.455 16.4302 112.871 17.8516 113.712 19.0211C114.073 19.4846 114.535 19.8599 115.062 20.1186C115.59 20.3773 116.169 20.5125 116.757 20.514C117.344 20.5156 117.925 20.3835 118.453 20.1276C118.982 19.8718 119.446 19.499 119.81 19.0374C120.652 17.8623 121.07 16.4358 120.994 14.992C121.071 13.5541 120.655 12.1329 119.816 10.9629C119.454 10.499 118.991 10.1237 118.462 9.86559C117.933 9.60748 117.352 9.47333 116.763 9.47333C116.175 9.47333 115.594 9.60748 115.065 9.86559C114.536 10.1237 114.073 10.499 113.71 10.9629' fill='#2D2D39'/>
<path d='M126.917 14.96C126.854 12.7337 127.647 10.5679 129.132 8.90825C129.91 8.12482 130.836 7.50306 131.855 7.07877C132.874 6.65447 133.967 6.43604 135.072 6.43604C136.176 6.43604 137.269 6.65447 138.288 7.07877C139.308 7.50306 140.233 8.12482 141.011 8.90825C142.497 10.58 143.289 12.7555 143.226 14.9913C143.29 17.2249 142.498 19.3985 141.011 21.0668C140.262 21.887 139.341 22.5327 138.315 22.9584C137.289 23.3841 136.182 23.5794 135.072 23.5305C135.069 23.53 135.067 23.5301 135.065 23.5308C135.063 23.5314 135.061 23.5326 135.059 23.5342C135.057 23.5358 135.056 23.5378 135.056 23.54C135.055 23.5422 135.055 23.5445 135.055 23.5467C133.948 23.5923 132.843 23.3947 131.82 22.9678C130.797 22.5408 129.879 21.895 129.132 21.0755C127.645 19.3894 126.853 17.2014 126.917 14.9538V14.96ZM131.732 18.8704C132.106 19.4005 132.607 19.8282 133.189 20.1144C133.77 20.4005 134.415 20.536 135.063 20.5083C135.712 20.5355 136.357 20.4014 136.941 20.1179C137.525 19.8345 138.03 19.4106 138.41 18.8842C139.194 17.7377 139.614 16.381 139.614 14.9919C139.614 13.6028 139.194 12.2461 138.41 11.0996C138.012 10.5916 137.504 10.181 136.923 9.89885C136.343 9.61669 135.706 9.47042 135.061 9.47114C134.416 9.47186 133.779 9.61956 133.2 9.90302C132.62 10.1865 132.113 10.5982 131.716 11.1071C130.905 12.2244 130.487 13.5789 130.528 14.9588C130.491 16.3608 130.914 17.7362 131.732 18.8754' fill='#2D2D39'/>
<path d='M150 0H146.517V23.2751H150V0Z' fill='#2D2D39'/>
<path d='M16.6054 24.7195C15.5035 24.7195 14.4154 24.6671 13.3572 24.5671C17.395 28.9923 21.9688 31.0711 24.9123 29.3708C26.7863 28.2876 27.6608 25.8627 27.5871 22.7681C24.0836 24.105 20.3588 24.7671 16.6092 24.7195' fill='#FD6157'/>
<path d='M16.6053 5.25939C17.7085 5.25939 18.7954 5.31187 19.8536 5.41181C15.8208 0.987919 11.2469 -1.09097 8.30351 0.608121C6.42951 1.69129 5.55497 4.11625 5.62868 7.21086C9.1322 5.87395 12.857 5.21182 16.6066 5.25939' fill='#FD6157'/>
<path d='M28.8309 9.37267C28.2367 13.0749 26.9476 16.6314 25.0316 19.8546C24.4782 20.8141 23.8885 21.7286 23.2726 22.5956C29.1232 21.3113 33.211 18.3904 33.211 14.9897C33.211 12.8233 31.5494 10.8506 28.8309 9.36768' fill='#55C0CF'/>
<path d='M8.1794 10.1258C8.73285 9.16632 9.32254 8.2518 9.93846 7.38477C4.08657 8.66908 0 11.5913 0 14.9907C0 17.1571 1.66037 19.1298 4.38017 20.6127C4.97418 16.91 6.26325 13.3531 8.1794 10.1296' fill='#55C0CF'/>
<path d='M25.0305 10.1241C25.5815 11.0786 26.08 12.0468 26.5297 13.0175C28.3388 7.30557 27.8515 2.30823 24.9081 0.609135C23.0341 -0.475288 20.4905 -0.0217793 17.8494 1.59486C20.7601 3.95951 23.1968 6.85399 25.0305 10.1253' fill='#A06BD6'/>
<path d='M8.17936 19.8549C7.6284 18.9004 7.12992 17.9322 6.68016 16.9614C4.86612 22.6709 5.35336 27.6707 8.29805 29.3711C10.172 30.4555 12.7157 30.002 15.3568 28.3853C12.446 26.0207 10.0094 23.1262 8.17561 19.8549' fill='#A06BD6'/>
</svg>
"
          />
        </Frame>
      </AutoLayout>
      <AutoLayout
        name="icebreaker"
        overflow="visible"
        spacing={8}
        padding={{
          top: 32,
          right: 32,
          bottom: 16,
          left: 32,
        }}
        width="fill-parent"
        horizontalAlignItems="center"
        verticalAlignItems="center"
      >
      <Text 
        fill="#493272"
        width="fill-parent"
        horizontalAlignText="center"
        lineHeight={38}
        fontFamily="IBM Plex Sans"
        fontSize={28}
      >
        {icebreaker?.question}
      </Text>
    </AutoLayout>  
    <AutoLayout
        name="bottom"
        overflow="visible"
        direction="vertical"
        spacing={8}
        padding={{
          vertical: 24,
          horizontal: 8,
        }}
        width="fill-parent"
        verticalAlignItems="center"
        horizontalAlignItems="center"
      >
        <AutoLayout
          name="button"
          fill="#493272"
          cornerRadius={72}
          overflow="visible"
          direction="vertical"
          padding={{
            vertical: 8,
            horizontal: 32,
          }}
          verticalAlignItems="center"
          horizontalAlignItems="center"
          onClick={() => {
            setIcebreaker(generateRandomIcebreaker(allIcebreakers()))
          }}
        >
          <Text
            name="Refresh"
            fill="#FFF"
            verticalAlignText="center"
            lineHeight={32}
            fontFamily="IBM Plex Sans"
            fontSize={20}
            fontWeight={500}
          >
            Refresh
          </Text>
        </AutoLayout>    
      </AutoLayout>
      <AutoLayout
        name="footer"
        overflow="visible"
        direction="horizontal"
        spacing={4}
        padding={{
          top: 0,
          right: 0,
          bottom: 12,
          left: 0,
        }}
        width="fill-parent"
        verticalAlignItems="center"
        horizontalAlignItems="center"
      >
        <Text
            name="Do more"
            fill="#82809A"
            verticalAlignText="center"
            fontSize={16}
            lineHeight={24}
            fontFamily="IBM Plex Sans"
          >
            Do more
          </Text>
          <Text
            name="with Parabol."
            fill="#82809A"
            verticalAlignText="center"
            fontSize={16}
            lineHeight={24}
            fontFamily="IBM Plex Sans"
            href={PARABOL_URI}
            textDecoration="underline"
          >
            with Parabol.
          </Text>
      </AutoLayout>
    </AutoLayout>
  );
}

widget.register(Widget)
